# puppet-agent

Run Puppet as a Daemonset in Kubernetes

![Version: 0.1.0](https://img.shields.io/badge/Version-0.1.0-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 5.5.1](https://img.shields.io/badge/AppVersion-5.5.1-informational?style=flat-square)

[puppet]: https://puppet.com/
[puppet_in_docker]: https://puppet.com/blog/puppet-docker-running-puppet-container-centric-infrastructure/
[agent]: https://puppet.com/docs/puppet/5.5/architecture.html
[daemonset]: https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/

This chart provides a mechanism for running [Puppet][puppet] in your Kubernetes
cluster as a [DaemonSet][daemonset]. This allows you to manage and observe the
[Puppet agent][agent] as a native Kubernetes resource, while still controlling
the configuration of the underlying host.

## Basic Usage

This chart makes very few assumptions about how your Puppet infrastructure
works. It is simply a wrapper for launching a privileged [Puppet Agent docker
image][puppet_in_docker] as a [DaemonSet][daemonset] in your Kubernetes
infrastructure.

### Default Security Privileges

By default the chart installs the DaemonSet so that it completely privileged on
your hosts - [hostNetwork, hostIPC, hostPid, and
more][https://kubernetes.io/docs/concepts/policy/pod-security-policy/] are all
enabled, giving the agent full root privileges.

### Default Puppet Configuration

Because Puppet can be run in so many different ways, we do not make any effort
to configure Puppet for you. You can pass in your own command line arguments
to the agent.

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| extraArgs | list | `[]` | Optional extra arguments to pass to the 'puppet agent' command. |
| fullnameOverride | string | `""` | Optionally fully override the entire name of the chart |
| hostIPC | bool | `true` | Runs the pod within the same IPC space as the host itself |
| hostNetwork | bool | `true` | Grants the pod host-level networking |
| hostPID | bool | `true` | Runs the pod within the same PID space as the host itself |
| image.pullPolicy | string | `"IfNotPresent"` |  |
| image.repository | string | `"puppet/puppet-agent-alpine"` | The repository where t |
| image.tag | string | `""` | Overrides the image tag whose default is the chart appVersion. |
| imagePullSecrets | list | `[]` | Optional image pull secrets if you are using a private registry |
| nameOverride | string | `""` | Optionally adds a "name" identifier to the end of the resources created by this chart. |
| nodeSelector | object | `{}` | Use a nodeSelector to narrow down the scope of where you want to run the Puppet agent processes. |
| podAnnotations | object | `{}` | Annotations added to the pods themselves |
| podSecurityContext | object | `{}` | Custmizes the podSecurityContext |
| pspEnabled | bool | `true` | Creates a PodSecurityPolicy for the DaemonSet |
| resources | object | `{}` | Pod resource customization |
| securityContext | object | `{"privileged":true}` | Customizes the securityContext spec for the agent container in the pod |
| serviceAccount.annotations | object | `{}` | Annotations to add to the service account |
| serviceAccount.create | bool | `true` | Specifies whether a service account should be created |
| serviceAccount.name | string | `""` | The name of the service account to use. -- If not set and create is true, a name is generated using the fullname template |
| tolerations | list | `[{"operator":"Exists"}]` | The default toleration grants this Pod access to run on every host regardless of its Taints. |
| volumeMounts | list | `[{"mountPath":"/tmp","name":"tmp"},{"mountPath":"/etc","name":"etc"},{"mountPath":"/var","name":"var"},{"mountPath":"/usr","name":"usr"},{"mountPath":"/lib64","name":"lib64"},{"mountPath":"/mnt","name":"mnt"},{"mountPath":"/opt","name":"opt"},{"mountPath":"/root","name":"root"},{"mountPath":"/home","name":"home"}]` | The list of volumeMounts that are applied the puppet agent container. This dictates how much control and access the agent has to the underlying host. The default setup is very widely scoped. |
| volumes | list | `[{"hostPath":{"path":"/tmp"},"name":"tmp"},{"hostPath":{"path":"/etc"},"name":"etc"},{"hostPath":{"path":"/var"},"name":"var"},{"hostPath":{"path":"/usr"},"name":"usr"},{"hostPath":{"path":"/lib64"},"name":"lib64"},{"hostPath":{"path":"/mnt"},"name":"mnt"},{"hostPath":{"path":"/opt"},"name":"opt"},{"hostPath":{"path":"/root"},"name":"root"},{"hostPath":{"path":"/home"},"name":"home"}]` | The list of volumes that are available to the puppet agent container to mount through the `.Values.volumeMounts` parameter. |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs v1.4.0](https://github.com/norwoodj/helm-docs/releases/v1.4.0)
